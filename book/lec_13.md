3. Комбинирование агрегатных функций с арифметическими операциями

**Пример**. Подсчет числа оценок и среднего балла по группе:
(pic)
**Пример**. Подсчет числа студентов, получающих стипендию и средней стипендии по группе:
(pic)

4. Допускается использование агрегатных функций с аргументами, которые состоят из выражений, включающих одно или более полей, при этом команда DISTINCT не разрешается.

5. Нельзя использовать агрегатную функцию от агрегатной функции.

6. Предложение GROUP BY  позволяет определять подмножество значений в поле в терминах другого поля, и применять функцию агрегата к такому подмножеству. Это дает возможность объединять поля и агрегатные функции в едином предложении SELECT.

**Пример**. Определить наименьшую оценку полученную каждым студентом.

```sql
SELECT Id_Stud, MIN (OCENKA)  FROM USP  GROUP BY Id_Stud;
```

Скалярные функции предназначены для обработки одного данного.

Скалярные функции разделяются на:

1. Функции работы с числами.

2. Функции работы со строками.

3. Функции работы с датой.

4. Функции явного преобразования типов данных.

5. Остальные.

**Функции работы с числами**

ABS(<*выражение*>) Возвращает абсолютное значение <*выражения*>

ACOS( ) Возвращает арккосинус

ASIN( ) Возвращает арксинус

ATAN( ) Возвращает арктангенс

CEILING( ) Возвращает наименьшее целое, которое больше или равно

COS( ) Возвращает косинус, угол указывается в радианах, а <выражение> имеет тип  float

COT( ) Возвращает котангенс

DEGREES( ) Принимает угол в радианах, а возвращает – в градусах.

EXP( ) Возвращает экспоненту

FLOOR( ) Возвращает наибольшее целое, которое меньше или равно ( )

**2. Функции работы со строками**

CHR(n) - Возвращает символ, ASCII-код которого равен n

CONCAT(c1, c2) - Объединяет строки c1 и c2.

INITCAP(c)  -Преобразует первый символ в каждом слове строки с к верхнему регистру

LOWER(с) - Преобразует символы строки с к нижнему регистру

LPAD(с, n) - Выполняет выравнивание строки с по правому краю поля длиной n-символов

REPLACE(с1, с2, с3) - Заменяет в строке с1 символы с2 на символы с3.

RPAD(с) - Выполняет выравнивание строки с по левому краю поля длиной n-символов

TRIM(с) - Удаляет пробелы в начале и в конце строки с

**3. Функции работы с датой**

LAST_DAY(d) - Возвращает дату последнего дня месяца даты d

MONTHS_BETWEEN(d1,d2) - Возвращает количество месяцев, которое прошло между d1 и d2

NEXT_DAY(d, с) - Возвращает дату следующего дня недели с относительно d (например, вернуть дату следующего вторника)

ROUND(d, fmt) - Округляет дату d согласно форматной строке fmt

SYSDATE - Возвращает текущее время и дату

TRUNC(d, fmt) - Обрезает дату d согласно форматной строке fmt

**4. Функции преобразования типов данных**

CAST (<Exp> AS <Type>) - Приведение выражения Expression к типу Type

CHARTOROWID(c) - Преобразует строку с из типа данных CHAR или VARCHAR2 к типу данных ROWID

HEXTORAW(с) - Преобразует шестнадцатиричную строку к типу данных RAW

RAWTOHEX(f) - Преобразует поле таблицы из типа данных RAW к строке шестнадцатиричных символов, которая содержит его эквивалент

TO_CHAR(d, fmt) - Преобразует дату d к строке, согласно форматной строке fmt

TO_CHAR(n) - Преобразует число к строке

TO_DATE(с, fmt) - Преобразует строку с, которая содержит дату и время в формате fmt к дате

TO_NUMBER(c) - Преобразует строку с к числу

|| - Конкатенация (сцепление) двух строк.

**5. Остальные функции SQL**

BFILENAME(*'dir', 'filename'*) - Возвращает локатор, который связан с файлом *filename*, находящимся в директории dir.

UID - Возвращает идентификатор подключенного к СУБД пользователя

USER - Возвращает имя подключенного к СУБД пользователя


